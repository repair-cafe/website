<div class="eventlist">
    {% if eventList.eventsGroupedByMonth|length > 0 %}
        {% for month, events in eventList.eventsGroupedByMonth %}
            <h2>{{ month|localizeddate_formatted('MMMM Y') }}</h2>
            <ul class="events list-unstyled mb-5">
                {% for event in events %}
                    {% set static_map_url = event.getStaticMapURL %}
                    {% set has_additional_information = (static_map_url and event.description is not empty) %}
                    {% set formatted_address = event.getFormattedAddress %}
                    <li class="pt-3" id="event{{ event.id }}">
                        <div class="row">
                            {% if eventList.condensed %}
                                <div class="col-md-6 mb-3">
                                    <h3 class="h5">{{ event.getTitle(eventList.condensed) }}</h3>
                                    {% partial 'components/date' start=event.start end=event.end %}
                                    {% if formatted_address is not empty %}
                                        <p class="small mb-0">{{ formatted_address }}</p>
                                    {% endif %}
                                </div>
                            {% else %}
                                <div class="col-md-6 media mb-3">
                                    {% if event.cafe.logo is not empty %}
                                        <img class="d-flex mr-3 w-25" src="{{ event.cafe.logo.path }}" alt="{{ event.cafe.title }}">
                                    {% elseif this.theme.repair_cafe_default_logo is not empty %}
                                        <img class="d-flex mr-3 w-25" src="{{ this.theme.repair_cafe_default_logo|media }}" alt="{{ event.cafe.title }}">
                                    {% endif%}
                                    <div class="media-body">
                                        <h3 class="h5"><a href="{{ 'cafe'|page({ slug: event.cafe.slug }) }}">{{ event.getTitle }}</a></h3>
                                        {% partial 'components/date' start=event.start end=event.end %}
                                        {% if formatted_address is not empty %}
                                            <p class="small mb-0">{{ formatted_address }}</p>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}
                            <div class="col-md-6 mb-3">
                                {% if has_additional_information %}
                                    <button type="button" class="close collapsed" data-toggle="collapse" data-target="#eventAdditionalInfo{{ event.id }}" aria-expanded="false" aria-controls="#eventAdditionalInfo{{ event.id }}">
                                        <i class="fa fa-chevron-toggle" aria-hidden="true"></i>
                                    </button>
                                {% endif %}
                                <ul class="list-unstyled">
                                    {% for category in event.categories %}
                                        {# TODO find better solution for link creation #}
                                        <li><a href="{{ 'cafes'|page ~ '?category=' ~ category.slug }}">{{ category.name }}<span class="sr-only">{{ category.description }}</span></a></li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        {% if has_additional_information %}
                            <div class="row additional-info collapse" id="eventAdditionalInfo{{ event.id }}">
                                {% if static_map_url %}
                                    <div class="col-md-6 mb-3">
                                        <a href="{{ event.getExternalMapURL }}" target="_blank"><img src="{{ static_map_url }}" class="img-fluid" /></a>
                                    </div>
                                {% endif %}
                                <div class="col-md-6 mb-3 small">
                                    <div class="mb-3 richeditor-content">
                                        {{ event.description|raw }}
                                    </div>
                                    {% if not eventList.condensed %}
                                        <div>
                                            <a class="btn btn-outline-primary" href="{{ 'cafe'|page({ slug: event.cafe.slug }) }}" role="button">{{ 'eventlist.cafe_detail_button'|_ }}</a>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endfor %}
        {{ eventList.events.render(eventList.boostrap_four_presenter)|raw }}
    {% else %}
        <p class="text-center">{{ 'eventlist.no_events_found'|_ }}</p>
    {% endif %}
</div>
