title = "Cafes"
url = "/cafes"
layout = "default"
is_hidden = 0

[eventList]
==
{% put page %}
    <div class="events">
        <div class="page-header disable-map">
            <div class="page-header-content-container container text-center">
                <div class="page-header-content row justify-content-center">
                    <div class="col-lg-8">
                        <h1>{{ 'eventlist.title'|_ }}</h1>
                        {{ form_open({ url: 'cafes'|page, method: 'GET', id: 'eventSearch' }) }}
                            <div class="row">
                                <div class="form-group col-md-8 pr-md-1 mb-2 mb-0">
                                    <div class="has-btn-embed has-btn-embed-right">
                                        <label for="searchterm" class="sr-only">{{ 'eventlist.search.searchterm.label'|_ }}</label>
                                        {{ form_input( 'search', 'searchterm', input('searchterm'), { class: 'form-control form-control-lg text-truncate', placeholder: 'eventlist.search.searchterm.placeholder'|_ } ) }}
                                        <button type="submit" class="btn btn-embed btn-embed-lg"><i class="fa fa-search" aria-hidden="true"></i></button>
                                    </div>
                                </div>
                                <div class="form-group col-md-4 pl-md-1 mb-0">
                                    <label for="category" class="sr-only">{{ 'eventlist.search.category.label'|_ }}</label>
                                    {{ form_select( 'category', eventList.categories, input('category'), { class: 'form-control form-control-lg' } ) }}
                                </div>
                            </div>
                        {{ form_close() }}
                    </div>
                </div>
            </div>
        </div>
        <div id="eventsMap"></div>
        <div class="page-content disable-map">
            <div class="container">
                <script type="text/javascript">
                    var repaircafe = {};
                    repaircafe['events'] = {{ eventList.eventsForMap|raw }};
                    repaircafe['config'] = {
                        'mapboxAccessToken': '{{ eventList.mapboxAccessToken }}'
                    };
                    repaircafe['labels'] = {
                        'date': '{{ "eventlist.map.date"|_ }}',
                        'address': '{{ "eventlist.map.address"|_ }}',
                        'categoryTitle': '{{ "eventlist.map.category_title"|_ }}'
                    };
                </script>
                {% partial 'components/eventlist' eventList=eventList %}
            </div>
        </div>
    </div>
{% endput %}

{% put scripts %}
    <script type="text/javascript" src="{{ 'assets/js/events-map.min.js'|theme }}"></script>
{% endput %}
